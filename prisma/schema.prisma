// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

// datasource db {
//   provider  = "postgresql"
//   url       = env("DATABASE_URL")
//   directUrl = env("DIRECT_URL")
// }

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  email    String?
  password String
}

// enum CotizacionStatus {
//   DRAFT // Borrador
//   SENT // Enviada
//   ACCEPTED // Aceptada
//   REJECTED // Rechazada
//   EXPIRED // Expirada
// }

enum CotizacionStatus {
  ESTADO1
  ESTADO2
  ESTADO3
  ESTADO4
  ESTADO5
  ESTADO6
}

enum CurrencyType {
  SOLES
  DOLARES
}

model Client {
  id         Int          @id @default(autoincrement())
  name       String
  contact    String
  ruc        String
  reference  String
  createAt   DateTime     @default(now())
  //agregar la relacion de cotizacion
  Cotizacion Cotizacion[]
}

model Cotizacion {
  id              Int              @id @default(autoincrement())
  status          CotizacionStatus @default(ESTADO1)
  code            String
  parentCode      String
  companyPhone    String
  companyEmail    String
  clientId        Int?
  client          Client?          @relation(fields: [clientId], references: [id])
  //Client ---
  clientName      String
  clientContact   String
  clientRuc       String
  clientReference String

  date         DateTime
  deliverTime  String
  totalPrice   Float
  currencyType CurrencyType // Tipo de moneda
  items        Json
  isEdit       Boolean      @default(false)

  //commercial conditions ---
  paymentCondition  String
  offerValidity     String // Validez de la oferta
  warranty          String // Garantía
  bankAccountNumber String // Número de cuenta bancaria de Movento S.A.C
}

model LastCodeCotizacion {
  id           Int @id @default(autoincrement())
  cotizacionId Int
  nextCode     Int @default(0)
}

model CodeCotizacion {
  id       Int @id @default(autoincrement())
  nextCode Int
}
